## 🧩 Solution to the Challenge

I began investigating the `?page=media&src=nsa` page because it was the **only clickable image** on the entire site — this stood out as a potential entry point. Clicking on it led to a more detailed media page displaying NSA-related images and descriptive text.

![Capture d’écran 2025-05-12 à 17 30 42](https://github.com/user-attachments/assets/dd430dbb-ab0e-4fee-acbd-3497406177e5)

While analyzing the structure of this page, I noticed that one of the key elements used was an HTML `<object>` tag, which dynamically loaded the image content:

```html
<object data="http://192.168.1.56/images/nsa_prism.jpg"></object>
```
![Capture d’écran 2025-05-12 à 17 33 07](https://github.com/user-attachments/assets/79f44efc-e3a9-405d-ae77-8a80be1ecffa)

This immediately caught my attention, as the `data` attribute was being constructed from the `src` URL parameter.

---

## 🕵️ Manual Testing:

I began manipulating the `src` parameter in the URL directly:

```
http://192.168.1.56/index.php?page=media&src=test
```

This resulted in the `<object>` attempting to load an invalid file, but the page still rendered — suggesting **no strict validation or filtering** of the input. This led me to explore whether I could control the content rendered by the `<object>` tag.

Knowing that the `<object>` element can load HTML, SVG, PDFs, or even `data:` URIs, I tested with various crafted inputs, including some pure HTML payloads like:

[https://developer.mozilla.org/en-US/docs/Web/URI/Reference/Schemes/data]

```
data:text/html,<p><a name="bottom">bottom</a></p>
```

![Capture d’écran 2025-05-12 à 17 34 42](https://github.com/user-attachments/assets/04fb3acf-da2f-4d84-8d73-683ace03ea0d)


These rendered correctly, but **no flag appeared**, indicating that simply rendering text wasn't enough.

---

## 🚨 Exploitation:

I then moved on to try **JavaScript-based payloads**, and tested this classic Base64 XSS trick:

```
http://192.168.1.56/index.php?page=media&src=data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==
```

Decoded, this is:

```html
<script>alert(1)</script>
```

The browser loaded the `data:` URI inside the `<object>`, interpreted it as HTML, and executed the JavaScript — triggering the alert. But more importantly, when this specific payload was used, **a hidden flag appeared** inside the rendered content.

No other payload (including purely HTML-based ones) triggered the flag, reinforcing that **JavaScript execution was necessary** to reveal it.

![Capture d’écran 2025-05-12 à 17 35 26](https://github.com/user-attachments/assets/05454583-cb94-4c32-960b-eb2423b26a01)

```928d819fc19405ae09921a2b71227bd9aba106f9d2d37ac412e9e5a750f1506d```
---

## 🛡️ Conclusion:

This part of the challenge exploited an **XSS vulnerability via the `<object>` element** and lack of sanitization on the `src` parameter. By injecting a `data:` URI with Base64-encoded HTML/JavaScript, I was able to execute code within the object context. The flag was not present statically — it was dynamically generated or revealed only upon script execution. This demonstrates a more advanced form of DOM-based XSS, requiring a deep understanding of browser behavior and HTML element capabilities.
